{"version":3,"file":"backdrop.js","sources":["../../src/util/backdrop.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): util/backdrop.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport EventHandler from '../dom/event-handler'\nimport { execute, executeAfterTransition, getElement, reflow, typeCheckConfig } from './index'\n\n/**\n * Constants\n */\n\nconst NAME = 'backdrop'\nconst CLASS_NAME_FADE = 'fade'\nconst CLASS_NAME_SHOW = 'show'\nconst EVENT_MOUSEDOWN = `mousedown.bs.${NAME}`\n\nconst Default = {\n  className: 'modal-backdrop',\n  isVisible: true, // if false, we use the backdrop helper without adding any element to the dom\n  isAnimated: false,\n  rootElement: 'body', // give the choice to place backdrop under different elements\n  clickCallback: null\n}\n\nconst DefaultType = {\n  className: 'string',\n  isVisible: 'boolean',\n  isAnimated: 'boolean',\n  rootElement: '(element|string)',\n  clickCallback: '(function|null)'\n}\n\n/**\n * Class definition\n */\n\nclass Backdrop {\n  constructor(config) {\n    this._config = this._getConfig(config)\n    this._isAppended = false\n    this._element = null\n  }\n\n  // Public\n  show(callback) {\n    if (!this._config.isVisible) {\n      execute(callback)\n      return\n    }\n\n    this._append()\n\n    const element = this._getElement()\n    if (this._config.isAnimated) {\n      reflow(element)\n    }\n\n    element.classList.add(CLASS_NAME_SHOW)\n\n    this._emulateAnimation(() => {\n      execute(callback)\n    })\n  }\n\n  hide(callback) {\n    if (!this._config.isVisible) {\n      execute(callback)\n      return\n    }\n\n    this._getElement().classList.remove(CLASS_NAME_SHOW)\n\n    this._emulateAnimation(() => {\n      this.dispose()\n      execute(callback)\n    })\n  }\n\n  dispose() {\n    if (!this._isAppended) {\n      return\n    }\n\n    EventHandler.off(this._element, EVENT_MOUSEDOWN)\n\n    this._element.remove()\n    this._isAppended = false\n  }\n\n  // Private\n  _getElement() {\n    if (!this._element) {\n      const backdrop = document.createElement('div')\n      backdrop.className = this._config.className\n      if (this._config.isAnimated) {\n        backdrop.classList.add(CLASS_NAME_FADE)\n      }\n\n      this._element = backdrop\n    }\n\n    return this._element\n  }\n\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...(typeof config === 'object' ? config : {})\n    }\n\n    // use getElement() with the default \"body\" to get a fresh Element on each instantiation\n    config.rootElement = getElement(config.rootElement)\n    typeCheckConfig(NAME, config, DefaultType)\n    return config\n  }\n\n  _append() {\n    if (this._isAppended) {\n      return\n    }\n\n    const element = this._getElement()\n    this._config.rootElement.append(element)\n\n    EventHandler.on(element, EVENT_MOUSEDOWN, () => {\n      execute(this._config.clickCallback)\n    })\n\n    this._isAppended = true\n  }\n\n  _emulateAnimation(callback) {\n    executeAfterTransition(callback, this._getElement(), this._config.isAnimated)\n  }\n}\n\nexport default Backdrop\n"],"names":["NAME","CLASS_NAME_FADE","CLASS_NAME_SHOW","EVENT_MOUSEDOWN","Default","className","isVisible","isAnimated","rootElement","clickCallback","DefaultType","Backdrop","constructor","config","_config","_getConfig","_isAppended","_element","show","callback","execute","_append","element","_getElement","reflow","classList","add","_emulateAnimation","hide","remove","dispose","EventHandler","off","backdrop","document","createElement","getElement","typeCheckConfig","append","on","executeAfterTransition"],"mappings":"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"}