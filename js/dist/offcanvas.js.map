{"version":3,"file":"offcanvas.js","sources":["../src/offcanvas.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): offcanvas.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport {\n  defineJQueryPlugin,\n  getElementFromSelector,\n  isDisabled,\n  isVisible,\n  typeCheckConfig\n} from './util/index'\nimport ScrollBarHelper from './util/scrollbar'\nimport EventHandler from './dom/event-handler'\nimport BaseComponent from './base-component'\nimport SelectorEngine from './dom/selector-engine'\nimport Manipulator from './dom/manipulator'\nimport Backdrop from './util/backdrop'\nimport FocusTrap from './util/focustrap'\nimport { enableDismissTrigger } from './util/component-functions'\n\n/**\n * Constants\n */\n\nconst NAME = 'offcanvas'\nconst DATA_KEY = 'bs.offcanvas'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\nconst ESCAPE_KEY = 'Escape'\n\nconst CLASS_NAME_SHOW = 'show'\nconst CLASS_NAME_BACKDROP = 'offcanvas-backdrop'\nconst OPEN_SELECTOR = '.offcanvas.show'\n\nconst EVENT_SHOW = `show${EVENT_KEY}`\nconst EVENT_SHOWN = `shown${EVENT_KEY}`\nconst EVENT_HIDE = `hide${EVENT_KEY}`\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\nconst EVENT_KEYDOWN_DISMISS = `keydown.dismiss${EVENT_KEY}`\n\nconst SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"offcanvas\"]'\n\nconst Default = {\n  backdrop: true,\n  keyboard: true,\n  scroll: false\n}\n\nconst DefaultType = {\n  backdrop: 'boolean',\n  keyboard: 'boolean',\n  scroll: 'boolean'\n}\n\n/**\n * Class definition\n */\n\nclass Offcanvas extends BaseComponent {\n  constructor(element, config) {\n    super(element)\n\n    this._config = this._getConfig(config)\n    this._isShown = false\n    this._backdrop = this._initializeBackDrop()\n    this._focustrap = this._initializeFocusTrap()\n    this._addEventListeners()\n  }\n\n  // Getters\n  static get NAME() {\n    return NAME\n  }\n\n  static get Default() {\n    return Default\n  }\n\n  // Public\n  toggle(relatedTarget) {\n    return this._isShown ? this.hide() : this.show(relatedTarget)\n  }\n\n  show(relatedTarget) {\n    if (this._isShown) {\n      return\n    }\n\n    const showEvent = EventHandler.trigger(this._element, EVENT_SHOW, { relatedTarget })\n\n    if (showEvent.defaultPrevented) {\n      return\n    }\n\n    this._isShown = true\n    this._element.style.visibility = 'visible'\n\n    this._backdrop.show()\n\n    if (!this._config.scroll) {\n      new ScrollBarHelper().hide()\n    }\n\n    this._element.removeAttribute('aria-hidden')\n    this._element.setAttribute('aria-modal', true)\n    this._element.setAttribute('role', 'dialog')\n    this._element.classList.add(CLASS_NAME_SHOW)\n\n    const completeCallBack = () => {\n      if (!this._config.scroll) {\n        this._focustrap.activate()\n      }\n\n      EventHandler.trigger(this._element, EVENT_SHOWN, { relatedTarget })\n    }\n\n    this._queueCallback(completeCallBack, this._element, true)\n  }\n\n  hide() {\n    if (!this._isShown) {\n      return\n    }\n\n    const hideEvent = EventHandler.trigger(this._element, EVENT_HIDE)\n\n    if (hideEvent.defaultPrevented) {\n      return\n    }\n\n    this._focustrap.deactivate()\n    this._element.blur()\n    this._isShown = false\n    this._element.classList.remove(CLASS_NAME_SHOW)\n    this._backdrop.hide()\n\n    const completeCallback = () => {\n      this._element.setAttribute('aria-hidden', true)\n      this._element.removeAttribute('aria-modal')\n      this._element.removeAttribute('role')\n      this._element.style.visibility = 'hidden'\n\n      if (!this._config.scroll) {\n        new ScrollBarHelper().reset()\n      }\n\n      EventHandler.trigger(this._element, EVENT_HIDDEN)\n    }\n\n    this._queueCallback(completeCallback, this._element, true)\n  }\n\n  dispose() {\n    this._backdrop.dispose()\n    this._focustrap.deactivate()\n    super.dispose()\n  }\n\n  // Private\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...Manipulator.getDataAttributes(this._element),\n      ...(typeof config === 'object' ? config : {})\n    }\n    typeCheckConfig(NAME, config, DefaultType)\n    return config\n  }\n\n  _initializeBackDrop() {\n    return new Backdrop({\n      className: CLASS_NAME_BACKDROP,\n      isVisible: this._config.backdrop,\n      isAnimated: true,\n      rootElement: this._element.parentNode,\n      clickCallback: () => this.hide()\n    })\n  }\n\n  _initializeFocusTrap() {\n    return new FocusTrap({\n      trapElement: this._element\n    })\n  }\n\n  _addEventListeners() {\n    EventHandler.on(this._element, EVENT_KEYDOWN_DISMISS, event => {\n      if (this._config.keyboard && event.key === ESCAPE_KEY) {\n        this.hide()\n      }\n    })\n  }\n\n  // Static\n  static jQueryInterface(config) {\n    return this.each(function () {\n      const data = Offcanvas.getOrCreateInstance(this, config)\n\n      if (typeof config !== 'string') {\n        return\n      }\n\n      if (data[config] === undefined || config.startsWith('_') || config === 'constructor') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config](this)\n    })\n  }\n}\n\n/**\n * Data API implementation\n */\n\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\n  const target = getElementFromSelector(this)\n\n  if (['A', 'AREA'].includes(this.tagName)) {\n    event.preventDefault()\n  }\n\n  if (isDisabled(this)) {\n    return\n  }\n\n  EventHandler.one(target, EVENT_HIDDEN, () => {\n    // focus on trigger when it is closed\n    if (isVisible(this)) {\n      this.focus()\n    }\n  })\n\n  // avoid conflict when clicking a toggler of an offcanvas, while another is open\n  const alreadyOpen = SelectorEngine.findOne(OPEN_SELECTOR)\n  if (alreadyOpen && alreadyOpen !== target) {\n    Offcanvas.getInstance(alreadyOpen).hide()\n  }\n\n  const data = Offcanvas.getOrCreateInstance(target)\n  data.toggle(this)\n})\n\nEventHandler.on(window, EVENT_LOAD_DATA_API, () => {\n  for (const selector of SelectorEngine.find(OPEN_SELECTOR)) {\n    Offcanvas.getOrCreateInstance(selector).show()\n  }\n})\n\nenableDismissTrigger(Offcanvas)\n\n/**\n * jQuery\n */\n\ndefineJQueryPlugin(Offcanvas)\n\nexport default Offcanvas\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","EVENT_LOAD_DATA_API","ESCAPE_KEY","CLASS_NAME_SHOW","CLASS_NAME_BACKDROP","OPEN_SELECTOR","EVENT_SHOW","EVENT_SHOWN","EVENT_HIDE","EVENT_HIDDEN","EVENT_CLICK_DATA_API","EVENT_KEYDOWN_DISMISS","SELECTOR_DATA_TOGGLE","Default","backdrop","keyboard","scroll","DefaultType","Offcanvas","BaseComponent","constructor","element","config","_config","_getConfig","_isShown","_backdrop","_initializeBackDrop","_focustrap","_initializeFocusTrap","_addEventListeners","toggle","relatedTarget","hide","show","showEvent","EventHandler","trigger","_element","defaultPrevented","style","visibility","ScrollBarHelper","removeAttribute","setAttribute","classList","add","completeCallBack","activate","_queueCallback","hideEvent","deactivate","blur","remove","completeCallback","reset","dispose","Manipulator","getDataAttributes","typeCheckConfig","Backdrop","className","isVisible","isAnimated","rootElement","parentNode","clickCallback","FocusTrap","trapElement","on","event","key","jQueryInterface","each","data","getOrCreateInstance","undefined","startsWith","TypeError","document","target","getElementFromSelector","includes","tagName","preventDefault","isDisabled","one","focus","alreadyOpen","SelectorEngine","findOne","getInstance","window","selector","find","enableDismissTrigger","defineJQueryPlugin"],"mappings":"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"}